<table class="table table-bordered table-striped" role="datatable">
  <thead class="thead-light">
  <tr>
    <th>Admission Date</th>
    <th>Admission No</th>
    <th>Patient Name</th>
    <th>Ward Number</th>
    <th>Ward Name</th>
    <th>Discharge Date</th>
    <th>Status</th>
    <th colspan="4">Action</th>
  </tr>
  </thead>
  <tbody>
  <% admissions&.each do |admission| %>
    <% patient = admission.patient %>
    <% ward = admission.ward %>
    <tr>
      <td><%= localize(admission.admissionDate) %></td>
      <td><%= admission.id %></td>
      <td><%= patient.person.firstName + ' ' + patient.person.lastName %></td>
      <td><%= ward.wardNumber %></td>
      <td><%= ward.name %></td>
      <td><%= admission.dischargeDate ? localize(admission.dischargeDate) : '--' %></td>
      <td><span class="badge badge-info"><%= admission.status %></span></td>
      <td colspan="4">
        <table class="borderless">
          <tbody>
          <tr class="bg-transparent">
            <td style="padding-top: 0.1em;">
              <%= link_to('View', admission_path(admission), role: 'button',
                          class: 'btn btn-secondary  btn-sm') %>
            </td>

            <% if display_discharge?(admission) %>
              <td style="padding-top: 0.1em;">
                <%#	 Displayed only the authorised staff (consultant/doctor) and discharge is not set/nil %>
                <%= link_to('Discharge', discharge_admission_path(admission.id), data: { modal: true }, role: 'button',
                            class: 'btn btn-secondary  btn-sm') %>
              </td>
            <% end %>
            <% if admission.scheduled? && policy(:admission).admit_scheduled? %>

              <td style="padding-top: 0.1em;">
                <%= link_to('Admit', admit_scheduled_admission_path(admission.id), data: { confirm: 'Admit now?' }, role: 'button',
                            class: 'btn btn-success  btn-sm', method: :patch) %>
              </td>
            <% end %>
            <% if admission.scheduled? && policy(:admission).cancel_scheduled? %>
              <td style="padding-top: 0.1em;">
                <%= link_to('Cancel', cancel_scheduled_admission_path(admission.id), data: { title: 'Cancel Scheduled Admission', confirm: "Should this admission no. #{admission.id} be cancel?" },
                            role: 'button', class: 'btn btn-danger btn-sm', method: :delete) %>
              </td>
            <% end %>
          </tr>
          </tbody>
        </table>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>

