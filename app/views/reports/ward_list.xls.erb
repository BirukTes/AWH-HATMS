<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
          xmlns:o="urn:schemas-microsoft-com:office:office"
          xmlns:x="urn:schemas-microsoft-com:office:excel"
          xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
          xmlns:html="http://www.w3.org/TR/REC-html40">
  <Worksheet ss:Name="Ward List">
    <Table>
      <Row>
        <Cell>
          <Data ss:Type="Number">Ward No</Data>
        </Cell>
        <Cell>
          <Data ss:Type="String">Ward Name</Data>
        </Cell>
        <Cell>
          <Data ss:Type="String">Patient Name</Data>
        </Cell>
        <Cell>
          <Data ss:Type="String">Patient Address</Data>
        </Cell>
        <Cell>
          <Data ss:Type="Date">Patient DOB</Data>
        </Cell>
        <Cell>
          <Data ss:Type="Number">Home Telephone No</Data>
        </Cell>
        <Cell>
          <Data ss:Type="Number">Mobile Telephone No</Data>
        </Cell>
        <Cell>
          <Data ss:Type="Date">Date Admitted</Data>
        </Cell>
      </Row>
      <% @admissions.each do |admission| %>
        <% patient = Patient.find(admission.patient_id) # TODO DRY this two %>
        <% ward = Ward.find(admission.ward_id) %>
        <Row>
          <Cell>
            <Data ss:Type="Number"><%= ward.wardNumber %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="String"><%= ward.name %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="String"><%= patient.person.firstName + ' ' + patient.person.lastName %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="String">
              <%= patient.person.address.houseNumber + ', ' + patient.person.address.street + ', ' +
                      patient.person.address.town + ', ' + patient.person.address.postcode %>
            </Data>
          </Cell>
          <Cell>
            <Data ss:Type="Date"><%= localize(patient.person.dateOfBirth) %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="Number"><%= patient.person.telHomeNo %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="Number"><%= patient.person.telMobileNo %></Data>
          </Cell>
          <Cell>
            <Data ss:Type="Date"><%= admission.admissionDate ? localize(admission.admissionDate) : '--' %></Data>
          </Cell>
          </tr>
        </Row>
      <% end %>
    </Table>
  </Worksheet>
</Workbook>